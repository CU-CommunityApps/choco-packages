Id:             'tableau-cis'
Description:    'Tableau 2022 - Fall2023a'
Version:        '2022.2'

Install:
    File:       '%INSTALL_DIR%\TableauDesktop-64bit-2022-2-0.exe'
    FileType:   'exe'
    Arguments:  '/quiet /norestart ACCEPTEULA=1 SKIPAPPLICATIONLAUNCH=1 SENDTELEMETRY=0 AUTOUPDATE=0 DESKTOPSHORTCUT=0 SCHEDULEREPORTINTERVAL=7200 REPORTINGSERVER=https://tableau.cornell.edu'
    ExitCodes:  [0,3010]

Applications:
    tableau:
        DisplayName:    'Tableau'
        Path:           '%WINDIR%\System32\WindowsPowerShell\v1.0\powershell.exe'
        LaunchParams:   '-Windowstyle Hidden -File \"%ProgramFiles%\Tableau\Tableau 2022.2\bin\tableau.ps1\" -Mode launch'
        WorkDir:        ''

Files:
    '%INSTALL_DIR%\tableau.ps1': '%ProgramFiles%\Tableau\Tableau 2022.2\bin\tableau.ps1' # Scheduled Task Script
    
Scripts:
    start:
        System: '%TOOLS_DIR%\startup.ps1' # Runs at system startup
    end:
        User:   '%TOOLS_DIR%\shutdown.ps1' # Runs at user logoff
        System: '%TOOLS_DIR%\shutdown.ps1' # Runs at system shutdown


Registry:
    HKUD:
        Software\Tableau\Registration\Data:
            company:
                Type:   'String'
                Value:  'Cornell'

            company_employees:
                Type:   'String'
                Value:  '15000'

            country:
                Type:   'String'
                Value:  'US'

            department:
                Type:   'String'
                Value:  'IT'

            email:
                Type:   'String'
                Value:  '$ENV:TABLEAU_EMAIL'

            first_name:
                Type:   'String'
                Value:  '$ENV:TABLEAU_FIRST_NAME'
                
            last_name:
                Type:   'String'
                Value:  '$ENV:TABLEAU_LAST_NAME'

            phone:
                Type:   'String'
                Value:  '$ENV:TABLEAU_PHONE'
            
            state:
                Type:   'String'
                Value:  'NY'

            title:
                Type:   'String'
                Value:  'IT Manager, Data Warehousing and Integrations'
