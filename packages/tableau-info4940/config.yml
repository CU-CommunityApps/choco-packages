Id:             'tableau-info4940'
Description:    'Tableau - INFO4940'
Version:        '2018.3.0'

Install:
    File:       '%INSTALL_DIR%\TableauDesktop-64bit-2018-3-0.exe'
    FileType:   'exe'
    Arguments:  '/quiet /norestart ACCEPTEULA=1 AUTOUPDATE=0 DESKTOPSHORTCUT=0'
    ExitCodes:  [0,3010]

Applications:
    tableau:
        DisplayName:    'Tableau'
        Path:           '%WINDIR%\System32\WindowsPowerShell\v1.0\powershell.exe'
        LaunchParams:   '-File "%ProgramFiles%\Tableau\Tableau 2018.3\bin\tableau.ps1" -Mode launch'
        WorkDir:        ''
        
Files:
    '%INSTALL_DIR%\tableau.ps1': '%ProgramFiles%\Tableau\Tableau 2018.3\bin\tableau.ps1' # Scheduled Task Script

ScheduledTasks:
    - 'Tableau_Activation'
    - 'Tableau_Prereqs'
    
Registry:
    HKUD:
        Software\Tableau\Registration\Data:
            email:
                Type:   'String'
                Value:  '%TABLEAU_EMAIL%'
                
    HKLM:
        Software\Tableau\ATR:
            ATREnabled:
                Type:   'String'
                Value:  '1'
                
            ATRRequestedDurationSeconds:
                Type:   'String'
                Value:  '57600'
